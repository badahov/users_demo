(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[9],{152:function(e,t,r){"use strict";var n=r(83),a=r.n(n);t.a={path:"user/edit/:userId/:page",getComponent:function(e,t){Promise.all([r.e(1),r.e(2),r.e(0),r.e(3),r.e(5),r.e(4),r.e(7),r.e(6),r.e(8),r.e(9),r.e(21)]).then(r.bind(null,276)).then((function(e){return t(null,e.default)})).catch((function(){return a.a}))}}},274:function(e,t,r){},276:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"user",(function(){return d}));var a=r(0),o=r.n(a),i=r(16),c=r(9),l=r(47),u=r(40),s={model:"edit",api:{item:"interface-users/user",edit:"interface-users/user-edit",current:"interface-users/user-current"},middleware:["USER_ITEM","USER_CURRENT"]},p=function(e){return function(t){return function(r){if(!s.middleware.includes(r.type))return t(r);Object(u.a)(e,r)}}},f="user".toUpperCase(),m=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;return e.includes(r.type)?r.data:t}},d=Object(c.combineReducers)({action:m(["".concat(f,"_ITEM_LOADING")]),current:m(["".concat(f,"_CURRENT_LOADED")]),item:m(["".concat(f,"_ITEM_LOADED")])}),b=Object(c.applyMiddleware)(p,l.a)(c.createStore)(Object(c.combineReducers)(n)),y=r(4),h=r(5),E=s.api;function v(e,t,r){return new y.e({pointApi:E.edit,data:e}).result().then((function(e){e&&r instanceof Function&&r(t)}))}var g="user".toUpperCase();function O(e){return{type:"".concat(g,"_ITEM"),actions:["".concat(g,"_ITEM_LOADING"),"".concat(g,"_ITEM_LOADED"),"".concat(g,"_ITEM_LOAD_FAILURE")],promise:(t=e,new y.e({pointApi:E.item,type:y.e.get,data:t}).result())};var t}function _(){return{type:"".concat(g,"_CURRENT"),actions:["".concat(g,"_CURRENT_LOADING"),"".concat(g,"_CURRENT_LOADED"),"".concat(g,"_CURRENT_LOAD_FAILURE")],promise:new y.e({domain:h.a.domain.auth,type:y.e.get,pointApi:E.current}).result()}}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"".concat(g,"_EDIT"),actions:["".concat(g,"_EDIT_LOADED")],model:v(e,t,r)}}var j=r(48),P=r.n(j),S=r(292),T=r(158),C=r(302),D=r(58),k=r(29),F=r(295),I=r(298),x=r(296),R=r(26);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function U(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?q(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e,t){return(z=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:5}}},H=function(e){function t(){var e,r;U(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return G(q(r=M(this,(e=B(t)).call.apply(e,[this].concat(a)))),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(t.operator_id=Number(r.props.user_id),r.props.actionEdit(t))}))})),G(q(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&z(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=!this.props.item;return o.a.createElement(T.a,{tip:"Загрузка...",size:"large",spinning:t},o.a.createElement(D.a,null,o.a.createElement(k.a,{span:24},o.a.createElement(C.a,N({},J,{onSubmit:this.handleSubmit}),o.a.createElement(D.a,{gutter:16,style:{marginBottom:"50px"}},o.a.createElement(C.a.Item,{label:"Код",hasFeedback:!0},e("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(o.a.createElement(F.a,{style:{width:"65%"},min:0,placeholder:"Код пользователя"}))),o.a.createElement(C.a.Item,{label:"Имя",hasFeedback:!0},e("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(o.a.createElement(I.a,{placeholder:"Имя пользователя"}))),o.a.createElement(C.a.Item,{label:"Логин",hasFeedback:!0},e("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(o.a.createElement(I.a,{placeholder:"Логин пользователя"}))),o.a.createElement(C.a.Item,{label:"Администратор"},e("is_admin",{valuePropName:"checked"})(o.a.createElement(x.a,null))),o.a.createElement(C.a.Item,{label:"Перепечать"},e("is_reprint_admin",{valuePropName:"checked"})(o.a.createElement(x.a,null)))),o.a.createElement(D.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},o.a.createElement(R.a,{type:"primary",htmlType:"submit"},"Изменить"))))))}}])&&L(r.prototype,n),a&&L(r,a),t}(a.Component);G(H,"defaultProps",{item:null});var K=H;function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var X=C.a.create({name:"user_data_form",mapPropsToFields:function(e){return{operator_code:C.a.createFormField(Q({},e.item.operator_code,{value:e.item.operator_code})),operator_name:C.a.createFormField(Q({},e.item.operator_name,{value:e.item.operator_name})),operator_login:C.a.createFormField(Q({},e.item.operator_login,{value:e.item.operator_login})),is_admin:C.a.createFormField(Q({},e.item.is_admin,{value:e.item.is_admin})),is_reprint_admin:C.a.createFormField(Q({},e.item.is_reprint_admin,{value:e.item.is_reprint_admin}))}}})(K);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ae={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:5}}},oe=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=ee(t).call(this,e),r=!a||"object"!==Y(a)&&"function"!=typeof a?te(n):a,ne(te(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,t.operator_id=Number(r.props.user_id),r.props.actionEdit(t))}))})),ne(te(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),ne(te(r),"compareToFirstPassword",(function(e,t,n){var a=r.props.form;t&&t!==a.getFieldValue("password")?n("Пароли не совпадают!"):n()})),ne(te(r),"validateToNextPassword",(function(e,t,n){var a=r.props.form;t&&r.state.confirmDirty&&a.validateFields(["confirm"],{force:!0}),n()})),r.state={confirmDirty:!1},r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement(D.a,null,o.a.createElement(k.a,{span:24},o.a.createElement(C.a,Z({},ae,{onSubmit:this.handleSubmit}),o.a.createElement(D.a,{gutter:16,style:{marginBottom:"50px"}},o.a.createElement(C.a.Item,{label:"Пароль",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(o.a.createElement(I.a.Password,null))),o.a.createElement(C.a.Item,{label:"Повторить пароль",hasFeedback:!0},e("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(o.a.createElement(I.a.Password,{onBlur:this.handleConfirmBlur})))),o.a.createElement(D.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},o.a.createElement(R.a,{type:"primary",htmlType:"submit"},"Изменить")))))}}])&&$(r.prototype,n),a&&$(r,a),t}(a.Component),ie=C.a.create({name:"user_password_form",mapPropsToFields:function(){return null}})(oe),ce=r(66);function le(e){return(le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(){return(ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function fe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var be=ce.a.Option,ye={labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:15}}},he=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=pe(t).call(this,e),r=!a||"object"!==le(a)&&"function"!=typeof a?fe(n):a,de(fe(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){if(!e){t.operator_id=Number(r.props.user_id);var n=[];t.roles.map((function(e){n.push({id:Number(e)})})),t.roles=n,r.props.actionEdit(t)}}))})),de(fe(r),"handleSelectedChange",(function(e){r.setState({selected:e})})),de(fe(r),"shouldComponentUpdate",(function(e,t){return t.options!==r.state.options||t.selected!==r.state.selected})),new y.e({pointApi:"interface-users/role-select"}).send().then((function(e){var t=[];e.map((function(e){t.push(o.a.createElement(be,{key:e.id},e.title))})),r.setState({options:t})})),r.state={options:[],selected:[]},r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement(D.a,null,o.a.createElement(k.a,{span:24},o.a.createElement(C.a,ue({},ye,{onSubmit:this.handleSubmit}),o.a.createElement(D.a,{gutter:16,style:{marginBottom:"50px"}},o.a.createElement(C.a.Item,{label:"Выбор ролей",hasFeedback:!0},e("roles",{})(o.a.createElement(ce.a,{mode:"multiple",style:{width:"100%"},placeholder:"Пожалуйста, выберите роли",onChange:this.handleSelectedChange},this.state.options)))),o.a.createElement(D.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},o.a.createElement(R.a,{type:"primary",htmlType:"submit"},"Изменить")))))}}])&&se(r.prototype,n),a&&se(r,a),t}(a.Component);function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){ge(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Oe=C.a.create({name:"user_roles_form",mapPropsToFields:function(e){var t=[];return e.item.roles&&(t=e.item.roles.map((function(e){return String(e.id)}))),{roles:C.a.createFormField(ve({},e.operator_code,{value:t}))}}})(he),_e=r(12),we=r(299),je=r(3),Pe=r(109),Se=S.a.Header,Te=function(e){return o.a.createElement(Se,null,o.a.createElement(we.a,{title:o.a.createElement("span",null,o.a.createElement(je.a,{className:"trigger",type:e.collapsed?"menu-unfold":"menu-fold",onClick:e.toggle}),e.title),subTitle:e.subTitle,extra:e.extra}),o.a.createElement(Pe.a,{mode:"horizontal"},o.a.createElement(Pe.a.Item,{key:"team"},o.a.createElement(_e.a,{to:"/"},o.a.createElement(je.a,{type:"team"}),"Пользователи")),o.a.createElement(Pe.a.Item,{key:"role"},o.a.createElement(_e.a,{to:"/role"},o.a.createElement(je.a,{type:"cluster"}),"Роли"))))},Ce=S.a.Sider,De=function(e){var t=e.collapsed,r=e.userId,n="1";switch(e.page){case"data":n="1";break;case"password":n="3";break;case"roles":n="4"}return o.a.createElement(Ce,{width:250,trigger:null,collapsible:!0,collapsed:t},o.a.createElement("div",{className:"logo"},"USER"),o.a.createElement(Pe.a,{theme:"dark",mode:"inline",defaultSelectedKeys:[n]},o.a.createElement(Pe.a.Item,{key:"1"},o.a.createElement(_e.a,{to:"/user/edit/".concat(r,"/data")},o.a.createElement(je.a,{type:"idcard"}),o.a.createElement("span",null,"Данные пользователя"))),o.a.createElement(Pe.a.Item,{key:"3"},o.a.createElement(_e.a,{to:"/user/edit/".concat(r,"/password")},o.a.createElement(je.a,{type:"safety"}),o.a.createElement("span",null,"Изменение пароля"))),o.a.createElement(Pe.a.Item,{key:"4"},o.a.createElement(_e.a,{to:"/user/edit/".concat(r,"/roles")},o.a.createElement(je.a,{type:"control"}),o.a.createElement("span",null,"Управление ролями")))))};function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ie(e){return(Ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Re(e,t){return(Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Ne=S.a.Content,Ue=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=Ie(t).call(this,e),r=!a||"object"!==ke(a)&&"function"!=typeof a?xe(n):a,Ae(xe(r),"toggle",(function(){r.setState({collapsed:!r.state.collapsed})})),Ae(xe(r),"renderTemplate",(function(e){var t,n=r.props,a=n.item,i=n.params.userId,c=n.actionEdit;switch(e){case"password":t=o.a.createElement(ie,{title:"Добавить пользователя",user_id:i,actionEdit:c,wrappedComponentRef:function(e){return r.form=e}});break;case"roles":t=o.a.createElement(Oe,{title:"Добавить пользователя",user_id:i,item:a,actionEdit:c,wrappedComponentRef:function(e){return r.form=e}});break;default:t=o.a.createElement(X,{title:"Добавить пользователя",user_id:i,item:a,actionEdit:c,wrappedComponentRef:function(e){return r.form=e}})}return t})),r.state={collapsed:!1},e.actionCurrent(),e.actionUser({id:e.params.userId}),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Re(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.item,r=e.current,n=e.params,a=n.page,i=n.userId,c=this.state.collapsed;if(t&&r){var l=t.operator_name,u=t.operator_login,s=!r;return o.a.createElement(S.a,null,o.a.createElement(De,{collapsed:c,page:a,userId:i}),o.a.createElement(S.a,null,o.a.createElement(P.a,{title:"Users"}),o.a.createElement(Te,{title:l,subTitle:"login: ".concat(u),collapsed:c,toggle:this.toggle,extra:[o.a.createElement(y.c,{key:"logout-1"})]}),o.a.createElement(Ne,{className:"user-edit"},o.a.createElement(T.a,{tip:"Загрузка...",size:"large",spinning:s},this.renderTemplate(a)))))}return null}}])&&Fe(r.prototype,n),a&&Fe(r,a),t}(o.a.Component);Ue.defaultProps={params:{userId:null}};var Le=Ue,Me=Object(i.connect)((function(e){return{access:e.user.access,action:e.user.action,current:e.user.current,item:e.user.item.data}}),(function(e){return Object(c.bindActionCreators)({actionCurrent:_,actionUser:O,actionEdit:w,dispatch:e},e)}))(Le);r(274),t.default=function(e){var t=e.location,r=e.params;return o.a.createElement(i.Provider,{store:b},o.a.createElement(Me,{location:t,params:r}))}}}]);
//# sourceMappingURL=edit.js.map