(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[8],{165:function(e,t,r){"use strict";var a=r(63),n=r.n(a);t.a={path:"user/edit/:userId/:page",getComponent:function(e,t){Promise.all([r.e(1),r.e(2),r.e(0),r.e(3),r.e(5),r.e(4),r.e(7),r.e(6),r.e(8),r.e(20)]).then(r.bind(null,290)).then((function(e){return t(null,e.default)})).catch((function(){return n.a}))}}},288:function(e,t,r){},290:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(21),l=r(22),s=r(67),i=r(64),c=r(54),u=Object(l.applyMiddleware)(Object(s.a)("system"),c.a)(l.createStore)(Object(l.combineReducers)({system:Object(i.a)({name:"system",models:[{name:"user",points:["item","current"]}]})})),m=r(4),p=r.n(m),d=r(68),f=r(5),b=r(6);var y="interface-users/user",h="interface-users/user-edit",E="interface-users/user-current";function g(e,t,r){switch(e){case"userItem":return new f.e({data:t,pointApi:y,type:f.e.get}).result();case"userCurrent":return new f.e({domain:b.a.domain.auth,type:f.e.get,pointApi:E}).result();case"userEdit":return new f.e({data:t,pointApi:h}).result()}}var v=r(12),O=r.n(v),w=r(13),_=r.n(w),j=r(16),P=r.n(j),k=r(17),S=r.n(k),F=r(7),x=r.n(F),C=r(18),I=r.n(C),D=r(55),T=r.n(D),A=r(305),N=r(170),q=r(315),B=r(40),R=r.n(B),z=r(69),U=r(36),J=r(308),H=r(311),K=r(309),M=r(33),V={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:5}}},G=function(e){function t(){var e,r;O()(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return r=P()(this,(e=S()(t)).call.apply(e,[this].concat(n))),p()(x()(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(t.operator_id=Number(r.props.user_id),r.props.submit(t))}))})),p()(x()(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),r}return I()(t,e),_()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t=!this.props.item;return n.a.createElement(N.a,{tip:"Загрузка...",size:"large",spinning:t},n.a.createElement(z.a,null,n.a.createElement(U.a,{span:24},n.a.createElement(q.a,R()({},V,{onSubmit:this.handleSubmit}),n.a.createElement(z.a,{gutter:16,style:{marginBottom:"50px"}},n.a.createElement(q.a.Item,{label:"Код",hasFeedback:!0},e("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(n.a.createElement(J.a,{style:{width:"65%"},min:0,placeholder:"Код пользователя"}))),n.a.createElement(q.a.Item,{label:"Имя",hasFeedback:!0},e("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(n.a.createElement(H.a,{placeholder:"Имя пользователя"}))),n.a.createElement(q.a.Item,{label:"Логин",hasFeedback:!0},e("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(n.a.createElement(H.a,{placeholder:"Логин пользователя"}))),n.a.createElement(q.a.Item,{label:"Администратор"},e("is_admin",{valuePropName:"checked"})(n.a.createElement(K.a,null))),n.a.createElement(q.a.Item,{label:"Перепечать"},e("is_reprint_admin",{valuePropName:"checked"})(n.a.createElement(K.a,null)))),n.a.createElement(z.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},n.a.createElement(M.a,{type:"primary",htmlType:"submit"},"Изменить"))))))}}]),t}(a.Component);p()(G,"defaultProps",{item:null});var L=G;function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function W(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){p()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var X=q.a.create({name:"user_data_form",mapPropsToFields:function(e){return{operator_code:q.a.createFormField(W({},e.item.operator_code,{value:e.item.operator_code})),operator_name:q.a.createFormField(W({},e.item.operator_name,{value:e.item.operator_name})),operator_login:q.a.createFormField(W({},e.item.operator_login,{value:e.item.operator_login})),is_admin:q.a.createFormField(W({},e.item.is_admin,{value:e.item.is_admin})),is_reprint_admin:q.a.createFormField(W({},e.item.is_reprint_admin,{value:e.item.is_reprint_admin}))}}})(L),Y={labelCol:{xs:{span:24},sm:{span:4}},wrapperCol:{xs:{span:24},sm:{span:5}}},Z=function(e){function t(e){var r;return O()(this,t),r=P()(this,S()(t).call(this,e)),p()(x()(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,t.operator_id=Number(r.props.user_id),r.props.submit(t))}))})),p()(x()(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),p()(x()(r),"compareToFirstPassword",(function(e,t,a){var n=r.props.form;t&&t!==n.getFieldValue("password")?a("Пароли не совпадают!"):a()})),p()(x()(r),"validateToNextPassword",(function(e,t,a){var n=r.props.form;t&&r.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()})),r.state={confirmDirty:!1},r}return I()(t,e),_()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.a.createElement(z.a,null,n.a.createElement(U.a,{span:24},n.a.createElement(q.a,R()({},Y,{onSubmit:this.handleSubmit}),n.a.createElement(z.a,{gutter:16,style:{marginBottom:"50px"}},n.a.createElement(q.a.Item,{label:"Пароль",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(n.a.createElement(H.a.Password,null))),n.a.createElement(q.a.Item,{label:"Повторить пароль",hasFeedback:!0},e("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(n.a.createElement(H.a.Password,{onBlur:this.handleConfirmBlur})))),n.a.createElement(z.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},n.a.createElement(M.a,{type:"primary",htmlType:"submit"},"Изменить")))))}}]),t}(a.Component),$=q.a.create({name:"user_password_form",mapPropsToFields:function(){return null}})(Z),ee=r(77),te=ee.a.Option,re={labelCol:{xs:{span:24},sm:{span:2}},wrapperCol:{xs:{span:24},sm:{span:15}}},ae=function(e){function t(e){var r;return O()(this,t),r=P()(this,S()(t).call(this,e)),p()(x()(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){if(!e){t.operator_id=Number(r.props.user_id);var a=t.roles.map((function(e){return{id:Number(e)}}));t.roles=a,r.props.submit(t)}}))})),p()(x()(r),"handleSelectedChange",(function(e){r.setState({selected:e})})),p()(x()(r),"shouldComponentUpdate",(function(e,t){return t.options!==r.state.options||t.selected!==r.state.selected})),new f.e({pointApi:"interface-users/role-select"}).send().then((function(e){var t=[];e.map((function(e){t.push(n.a.createElement(te,{key:e.id},e.title))})),r.setState({options:t})})),r.state={options:[],selected:[]},r}return I()(t,e),_()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.a.createElement(z.a,null,n.a.createElement(U.a,{span:24},n.a.createElement(q.a,R()({},re,{onSubmit:this.handleSubmit}),n.a.createElement(z.a,{gutter:16,style:{marginBottom:"50px"}},n.a.createElement(q.a.Item,{label:"Выбор ролей",hasFeedback:!0},e("roles",{})(n.a.createElement(ee.a,{mode:"multiple",style:{width:"100%"},placeholder:"Пожалуйста, выберите роли",onChange:this.handleSelectedChange},this.state.options)))),n.a.createElement(z.a,{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px 0 10px",background:"#fff",textAlign:"left"}},n.a.createElement(M.a,{type:"primary",htmlType:"submit"},"Изменить")))))}}]),t}(a.Component);function ne(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(r),!0).forEach((function(t){p()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var le=q.a.create({name:"user_roles_form",mapPropsToFields:function(e){var t=[];return e.item.roles&&(t=e.item.roles.map((function(e){return String(e.id)}))),{roles:q.a.createFormField(oe({},e.operator_code,{value:t}))}}})(ae),se=r(15),ie=r(312),ce=r(3),ue=r(121),me=A.a.Header,pe=function(e){return n.a.createElement(me,null,n.a.createElement(ie.a,{title:n.a.createElement("span",null,n.a.createElement(ce.a,{className:"trigger",type:e.collapsed?"menu-unfold":"menu-fold",onClick:e.toggle}),e.title),subTitle:e.subTitle,extra:e.extra}),n.a.createElement(ue.a,{mode:"horizontal"},n.a.createElement(ue.a.Item,{key:"team"},n.a.createElement(se.a,{to:"/"},n.a.createElement(ce.a,{type:"team"}),"Пользователи")),n.a.createElement(ue.a.Item,{key:"role"},n.a.createElement(se.a,{to:"/role"},n.a.createElement(ce.a,{type:"cluster"}),"Роли"))))},de=A.a.Sider,fe=function(e){var t=e.collapsed,r=e.userId,a="1";switch(e.page){case"data":a="1";break;case"password":a="3";break;case"roles":a="4"}return n.a.createElement(de,{width:250,trigger:null,collapsible:!0,collapsed:t},n.a.createElement("div",{className:"logo"},"USER"),n.a.createElement(ue.a,{theme:"dark",mode:"inline",defaultSelectedKeys:[a]},n.a.createElement(ue.a.Item,{key:"1"},n.a.createElement(se.a,{to:"/user/edit/".concat(r,"/data")},n.a.createElement(ce.a,{type:"idcard"}),n.a.createElement("span",null,"Данные пользователя"))),n.a.createElement(ue.a.Item,{key:"3"},n.a.createElement(se.a,{to:"/user/edit/".concat(r,"/password")},n.a.createElement(ce.a,{type:"safety"}),n.a.createElement("span",null,"Изменение пароля"))),n.a.createElement(ue.a.Item,{key:"4"},n.a.createElement(se.a,{to:"/user/edit/".concat(r,"/roles")},n.a.createElement(ce.a,{type:"control"}),n.a.createElement("span",null,"Управление ролями")))))},be=A.a.Content,ye=function(e){function t(e){var r;return O()(this,t),r=P()(this,S()(t).call(this,e)),p()(x()(r),"toggle",(function(){r.setState({collapsed:!r.state.collapsed})})),p()(x()(r),"renderTemplate",(function(e){var t,a=r.props,o=a.item,l=a.params.userId,s=a.modelEdit;switch(e){case"password":t=n.a.createElement($,{title:"Добавить пользователя",user_id:l,submit:s,wrappedComponentRef:function(e){return r.form=e}});break;case"roles":t=n.a.createElement(le,{title:"Добавить пользователя",user_id:l,item:o,submit:s,wrappedComponentRef:function(e){return r.form=e}});break;default:t=n.a.createElement(X,{title:"Добавить пользователя",user_id:l,item:o,submit:s,wrappedComponentRef:function(e){return r.form=e}})}return t})),r.state={collapsed:!1},e.modelServer(),r}return I()(t,e),_()(t,[{key:"render",value:function(){var e=this.props,t=e.item,r=e.current,a=e.params,o=a.page,l=a.userId,s=this.state.collapsed;if(t&&r){var i=t.operator_name,c=t.operator_login,u=!r;return n.a.createElement(A.a,null,n.a.createElement(fe,{collapsed:s,page:o,userId:l}),n.a.createElement(A.a,null,n.a.createElement(T.a,{title:"Users"}),n.a.createElement(pe,{title:i,subTitle:"login: ".concat(c),collapsed:s,toggle:this.toggle,extra:[n.a.createElement(f.c,{key:"logout-1"})]}),n.a.createElement(be,{className:"user-edit"},n.a.createElement(N.a,{tip:"Загрузка...",size:"large",spinning:u},this.renderTemplate(o)))))}return null}}]),t}(n.a.Component);ye.defaultProps={params:{userId:null}};var he=ye;function Ee(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}var ge=Object(o.connectAdvanced)((function(e){var t={},r={},a=Object(d.a)(g,"system",e),n=function(e){return a("userItem",e)},l=function(e){return a("userEdit",e,(function(e){return n(t.location.query),e}))},s=function(){a("userCurrent"),n({id:t.params.userId})};return function(e,a){var n=function(e){return null===e},i=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(r),!0).forEach((function(t){p()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},a,{loading:!!n(e.system.userItem),item:n(e.system.userItem)?null:e.system.userItem.data,access:n(e.system.userItem)?null:e.system.userItem.access,current:n(e.system.userCurrent)?null:e.system.userCurrent.data,modelEdit:l,modelServer:s});return t=a,Object(o.shallowEqual)(r,i)||(r=i),r}}))(he);r(288),t.default=function(e){var t=e.location,r=e.params;return n.a.createElement(o.Provider,{store:u},n.a.createElement(ge,{location:t,params:r}))}}}]);
//# sourceMappingURL=edit.js.map