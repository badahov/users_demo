(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[10],{164:function(e,t,r){"use strict";var a=r(63),n=r.n(a);t.a={getComponent:function(e,t){Promise.all([r.e(1),r.e(2),r.e(0),r.e(3),r.e(5),r.e(4),r.e(7),r.e(6),r.e(10),r.e(18)]).then(r.bind(null,292)).then((function(e){return t(null,e.default)})).catch((function(){return n.a}))}}},287:function(e,t,r){},292:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),s=r(21),l=r(22),o=r(67),i=r(64),c=r(54),u=Object(l.applyMiddleware)(Object(o.a)("system"),c.a)(l.createStore)(Object(l.combineReducers)({system:Object(i.a)({name:"system",models:[{name:"user",points:["header","items","current"]}]})})),m=r(4),d=r.n(m),p=r(68),h=r(5),f=r(6),y="interface-users/items",E="interface-users/user-delete",b="interface-users/user-add",g="interface-users/user-current";function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:h.e.post;return new h.e({pointApi:e,type:r,data:t})}function w(e,t,r){switch(e){case"userHeader":return{code:0!==t.code?t.code:"",name:0!==t.name?t.name:"",login:0!==t.login?t.login:"",status:0===t.status?"0":"1"};case"userItems":return new h.e({pointApi:y,data:t}).result();case"userDelete":return v(E,t,h.e.post).result(r);case"userAdd":return v(b,t,h.e.post).result(r);case"userCurrent":return new h.e({domain:f.a.domain.auth,type:h.e.get,pointApi:g}).result()}}var k=r(12),C=r.n(k),S=r(13),A=r.n(S),F=r(16),I=r.n(F),O=r(17),U=r.n(O),P=r(7),_=r.n(P),q=r(18),x=r.n(q),D=r(55),j=r.n(D),M=r(15),N=r(305),H=r(121),T=r(3),z=r(170),R=r(312),B=r(33),W=r(69),K=r(36),J=(r(1),r(306)),L=function(e){function t(){return C()(this,t),I()(this,U()(t).apply(this,arguments))}return x()(t,e),A()(t,[{key:"render",value:function(){var e=this,t=this.props,r=t.isAdmin,a=t.isReprintAdmin,s=t.userCode,l=t.userName,o=t.userLogin,i=t.access,c=t.userId,u=r?"Да":"Нет",m=a?"Да":"Нет";return n.a.createElement("tr",null,n.a.createElement("td",null,s),n.a.createElement("td",null,l),n.a.createElement("td",null,o),n.a.createElement("td",null,u),n.a.createElement("td",null,m),n.a.createElement("td",{className:"box-button"},n.a.createElement(B.a.Group,null,i.user.update?n.a.createElement(M.a,{className:"ant-btn ant-btn-primary ant-btn-sm ant-btn-icon-only",title:"Изменить",to:"/user/edit/".concat(c,"/data")},n.a.createElement(T.a,{type:"edit"})):null,i.user.delete?n.a.createElement(J.a,{title:"Удалить пользователя?",onConfirm:function(){return e.props.onDeleteUser(c)},okText:"Да",cancelText:"Нет",placement:"left",zIndex:1050},n.a.createElement(B.a,{type:"primary",size:"small",icon:"delete"})):null)))}}]),t}(a.Component),Q=r(169),Z=r.n(Q),G=r(40),V=r.n(G),X=r(307),Y=r(315),$=r(308),ee=r(311),te=r(309),re={position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:2e3},ae={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12}}},ne=function(e){function t(){var e,r;C()(this,t);for(var a=arguments.length,n=new Array(a),s=0;s<a;s++)n[s]=arguments[s];return r=I()(this,(e=U()(t)).call.apply(e,[this].concat(n))),d()(_()(r),"state",{DrawerWidth:550,DrawerZIndex:1050}),d()(_()(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,r.props.submitForm(t))}))})),d()(_()(r),"onClose",(function(){r.props.onClose()})),d()(_()(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),d()(_()(r),"compareToFirstPassword",(function(e,t,a){var n=r.props.form;t&&t!==n.getFieldValue("password")?a("Пароли не совпадают!"):a()})),d()(_()(r),"validateToNextPassword",(function(e,t,a){var n=r.props.form;t&&r.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()})),r}return x()(t,e),A()(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.a.createElement(X.a,{title:this.props.title,width:this.state.DrawerWidth,onClose:this.onClose,visible:this.props.visible,zIndex:this.state.DrawerZIndex},n.a.createElement(Y.a,V()({},ae,{onSubmit:this.handleSubmit}),n.a.createElement(W.a,{gutter:16,style:{marginBottom:"20px"}},n.a.createElement(Y.a.Item,{label:"Код",hasFeedback:!0},e("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(n.a.createElement($.a,{style:{width:"65%"},min:1,placeholder:"Код пользователя"}))),n.a.createElement(Y.a.Item,{label:"Имя",hasFeedback:!0},e("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(n.a.createElement(ee.a,{placeholder:"Имя пользователя"}))),n.a.createElement(Y.a.Item,{label:"Логин",hasFeedback:!0},e("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(n.a.createElement(ee.a,{placeholder:"Логин пользователя"}))),n.a.createElement(Y.a.Item,{label:"Пароль",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(n.a.createElement(ee.a.Password,null))),n.a.createElement(Y.a.Item,{label:"Повторить пароль",hasFeedback:!0},e("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(n.a.createElement(ee.a.Password,{onBlur:this.handleConfirmBlur}))),n.a.createElement(Y.a.Item,{label:"Администратор"},e("is_admin",{valuePropName:"checked"})(n.a.createElement(te.a,null))),n.a.createElement(Y.a.Item,{label:"Перепечать"},e("is_reprint_admin",{valuePropName:"checked"})(n.a.createElement(te.a,null)))),n.a.createElement(W.a,{style:re},n.a.createElement(B.a,{onClick:this.onClose,style:{marginRight:8}},"Закрыить"),n.a.createElement(B.a,{type:"primary",htmlType:"submit"},"Отправить"))))}}]),t}(a.Component),se=Z.a.create({name:"user_add_form",mapPropsToFields:function(e){return{}}})(ne),le=N.a.Header,oe=N.a.Content,ie=N.a.Sider,ce=function(e){function t(e){var r;return C()(this,t),r=I()(this,U()(t).call(this,e)),d()(_()(r),"shouldComponentUpdate",(function(e,t){var a=r.props,n=a.items,s=a.location,l=a.header,o=a.modelItems,i=a.loading,c=a.location.query,u=r.state,m=u.page,d=u.collapsedSiderMenu,p=u.visibleUserAddForm;return new h.b({params:["name","code","login"],query:s.query,nextHeader:e.header,header:l,page:m,action:function(){o(c)}}).isUpdate(),i!==e.loading||d!==t.collapsedSiderMenu||p!==t.visibleUserAddForm||l!==e.header||n!==e.items})),d()(_()(r),"onCloseUserAddForm",(function(){r.setState({visibleUserAddForm:!1})})),d()(_()(r),"onOpenUserAddForm",(function(){r.setState({visibleUserAddForm:!r.state.visibleUserAddForm})})),d()(_()(r),"switchSiderMenu",(function(){r.setState({collapsedSiderMenu:!r.state.collapsedSiderMenu})})),r.state={siderWidth:200,menuSelectedKeys:["left-menu-1"],collapsedSiderMenu:e.collapsedSiderMenu,visibleUserAddForm:e.visibleUserAddForm},e.modelCurrentUser(),e.modelServer(),r}return x()(t,e),A()(t,[{key:"render",value:function(){var e=this;return n.a.createElement(N.a,null,n.a.createElement(ie,{width:this.state.siderWidth,trigger:null,collapsible:!0,collapsed:this.state.collapsedSiderMenu},n.a.createElement("div",{className:"logo"},"USER"),n.a.createElement(H.a,{theme:"dark",mode:"inline",defaultSelectedKeys:this.state.menuSelectedKeys},n.a.createElement(H.a.Item,{key:"left-menu-1"},n.a.createElement(M.a,{to:"/"},n.a.createElement(T.a,{type:"team"}),n.a.createElement("span",null,"Пользователи"))),n.a.createElement(H.a.Item,{key:"left-menu-2"},n.a.createElement(M.a,{to:"/role"},n.a.createElement(T.a,{type:"cluster"}),n.a.createElement("span",null,"Роли"))))),n.a.createElement(N.a,null,n.a.createElement(z.a,{tip:"Загрузка...",size:"large",spinning:this.props.loading},n.a.createElement(j.a,{title:"Users"}),n.a.createElement(le,null,n.a.createElement(R.a,{subTitle:"Пользователи",title:n.a.createElement("span",null,n.a.createElement(T.a,{className:"trigger",type:this.state.collapsedSiderMenu?"menu-unfold":"menu-fold",onClick:this.switchSiderMenu}),"Users"),extra:[n.a.createElement(B.a,{key:"add-user",className:"btn-user-add",type:"primary",icon:"user-add",size:"small",onClick:function(){return e.onOpenUserAddForm()}},"Добавить пользователя"),n.a.createElement(h.c,{key:"logout-1"})]})),n.a.createElement(oe,{className:"user-list"},n.a.createElement(W.a,null,n.a.createElement(K.a,{span:24},n.a.createElement(h.h,{overlayClassName:"table-users",striped:!1,thead:[n.a.createElement("th",{key:"ht-1"},n.a.createElement(h.a,null,n.a.createElement(h.f,{callback:this.props.setHeader,model:"code",value:this.props.header.code,placeholder:"Код",isFocus:!0}),n.a.createElement(h.g,{id:"code",fsort:this.props.sort}))),n.a.createElement("th",{key:"ht-2"},n.a.createElement(h.a,null,n.a.createElement(h.f,{callback:this.props.setHeader,model:"name",value:this.props.header.name,placeholder:"Имя"}),n.a.createElement(h.g,{id:"name",fsort:this.props.sort}))),n.a.createElement("th",{key:"ht-3"},n.a.createElement(h.a,null,n.a.createElement(h.f,{callback:this.props.setHeader,model:"login",value:this.props.header.login,placeholder:"Логин"}),n.a.createElement(h.g,{id:"login",fsort:this.props.sort}))),n.a.createElement("th",{key:"ht-4"},n.a.createElement(h.i,null,"Админ")),n.a.createElement("th",{key:"ht-5"},n.a.createElement(h.i,null,"Перепечать")),n.a.createElement("th",{key:"ht-6"})]},this.props.items?this.props.items.map((function(t){return n.a.createElement(L,{key:t.operator_id,userId:t.operator_id,userCode:t.operator_code,userName:t.operator_name,userLogin:t.operator_login,isAdmin:t.is_admin,isReprintAdmin:t.is_reprint_admin,access:e.props.access,onDeleteUser:e.props.modelDelete})})):null)),n.a.createElement(K.a,{span:24},this.props.paginate?n.a.createElement(h.d,{url:"/",data:this.props.paginate,onQuery:this.props.modelItems}):null),n.a.createElement(se,{title:"Добавить пользователя",visible:this.state.visibleUserAddForm,urlQuery:this.props.location.query,submitForm:this.props.modelAdd,onClose:this.onCloseUserAddForm,wrappedComponentRef:function(t){return e.form=t}}))))))}}]),t}(n.a.Component);ce.defaultProps={loading:!0,location:{query:{}}};var ue=ce;function me(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}var de=Object(s.connectAdvanced)((function(e){var t="system",r={},a={},n=Object(p.a)(w,t,e),l=function(){return n("userCurrent")},o=function(e){return n("userItems",e)},i=function(e){return n("userHeader",e)},c=function(e){return n("userAdd",e,(function(e){return o(r.location.query),e}))},u=function(e){return n("userDelete",{id:e},(function(e){return o(r.location.query),e}))},m=function(){i(r.location.query),o(r.location.query)},h=function(e,t){r.location.query[e]=t,i(r.location.query)},f=function(e){r.location.query.sort=e,o(r.location.query)};return function(e,t){var n=function(e){return null===e},p=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?me(Object(r),!0).forEach((function(t){d()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{loading:!!n(e.system.userItems),header:n(e.system.userItems)?[]:e.system.userHeader,items:n(e.system.userItems)?null:e.system.userItems.data,paginate:n(e.system.userItems)?null:e.system.userItems.paginate,access:n(e.system.userItems)?null:e.system.userItems.access,current:n(e.system.userCurrent)?null:e.system.userCurrent.data,setHeader:h,modelCurrentUser:l,modelItems:o,modelHeader:i,modelServer:m,modelAdd:c,modelDelete:u,sort:f});return r=t,Object(s.shallowEqual)(a,p)||(a=p),a}}))(ue),pe=(r(287),function(e){var t=e.location,r=e.visibleUserAddForm,a=e.collapsedSiderMenu;return n.a.createElement(s.Provider,{store:u},n.a.createElement(de,{location:t,visibleUserAddForm:r,collapsedSiderMenu:a}))});pe.defaultProps={visibleUserAddForm:!1,collapsedSiderMenu:!0};t.default=pe}}]);
//# sourceMappingURL=users.js.map