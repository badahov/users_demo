(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[13],{245:function(e,t,r){"use strict";var a=r(0),n=r.n(a),o=r(1),l=r.n(o),i=r(47),s=r(20),u=r(117),c=r(252),m=r(233),d=Object(s.a)(Object(c.a)("system"),u.a)(s.d)(Object(s.c)({system:Object(m.a)({name:"system",models:[{name:"user",points:["header","items","current"]}]})})),p=r(71),f=r.n(p),b=r(253),y=r(130),h=r(8),E="interface-users/items",v="interface-users/user-delete",g="interface-users/user-add",w="interface-users/user-current";function O(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return new y.a({pointApi:e,type:r,data:t})}function S(e,t,r){switch(e){case"userHeader":return{code:0!==t.code?t.code:"",name:0!==t.name?t.name:"",login:0!==t.login?t.login:"",status:0===t.status?"0":"1"};case"userItems":return new y.a({data:t,pointApi:E}).result();case"userDelete":return O(v,t).result(r);case"userAdd":return O(g,t).result(r);case"userCurrent":return new y.a({domain:h.a.domain.auth,type:"GET",pointApi:w}).result();default:return null}}var q=r(68),k=r.n(q),R=r(92),j=r.n(R),C=r(81),_=r(32),I=r(513),A=r(172),P=r(5),F=r(514),U=r(517),D=r(37),T=r(510),N=r(515),x=r(508),M=function(e){var t=e.isAdmin,r=e.isReprintAdmin,a=e.userCode,o=e.userName,l=e.userLogin,i=e.access,s=e.userId,u=e.onDeleteUser,c=t?"Да":"Нет",m=r?"Да":"Нет",d=i.user,p=d.update,f=d.delete;return n.a.createElement("tr",null,n.a.createElement("td",null,a),n.a.createElement("td",null,o),n.a.createElement("td",null,l),n.a.createElement("td",null,c),n.a.createElement("td",null,m),n.a.createElement("td",{className:"box-button"},n.a.createElement(D.a.Group,null,p?n.a.createElement(_.b,{className:"ant-btn ant-btn-primary ant-btn-sm ant-btn-icon-only",title:"Изменить",to:"/user/edit/".concat(s,"/data")},n.a.createElement(P.a,{type:"edit"})):null,function(e){return e?n.a.createElement(x.a,{title:"Удалить пользователя?",onConfirm:function(){return u(s)},okText:"Да",cancelText:"Нет",placement:"left",zIndex:1050},n.a.createElement(D.a,{type:"primary",size:"small",icon:"delete"})):null}(f))))};M.propTypes={access:l.a.shape({user:l.a.shape({delete:l.a.bool.isRequired,update:l.a.bool.isRequired}).isRequired}).isRequired,isAdmin:l.a.bool.isRequired,isReprintAdmin:l.a.bool.isRequired,userCode:l.a.number.isRequired,userId:l.a.number.isRequired,userLogin:l.a.string.isRequired,userName:l.a.string.isRequired,onDeleteUser:l.a.func.isRequired};var H=n.a.memo(M),W=r(125),z=r.n(W),L=r(238),B=r.n(L),J=r(509),K=r(518),G=r(511),Q=r(516),Z=r(512);function V(e){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ee(e,t){return(ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function te(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var re=function(e){function t(e){var r,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=Y(t).call(this,e),r=!n||"object"!==V(n)&&"function"!=typeof n?$(a):n,te($(r),"handleConfirmBlur",(function(e){var t=e.target.value,a=r.state.confirmDirty;r.setState({confirmDirty:a||!!t})})),te($(r),"compareToFirstPassword",(function(e,t,a){var n=r.props.form;t&&t!==n.getFieldValue("password")?a("Пароли не совпадают!"):a()})),r.state={DrawerWidth:550,DrawerZIndex:1050,formItemLayout:{labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12}}}},r.handleSubmit=r.handleSubmit.bind($(r)),r.handleSubmitThrottled=B()(r.handleSubmit,1e3),r}var r,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ee(e,t)}(t,e),r=t,(a=[{key:"componentWillUnmount",value:function(){this.handleSubmitThrottled.cancel()}},{key:"validateToNextPassword",value:function(e,t,r){var a=this.props.form,n=this.state.confirmDirty;t&&n&&a.validateFields(["confirm"],{force:!0}),r()}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.props,r=t.form,a=t.submitForm;r.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,a(t))}))}},{key:"render",value:function(){var e=this.props,t=e.title,r=e.onClose,a=e.visible,o=e.form.getFieldDecorator,l=this.state,i=l.DrawerWidth,s=l.DrawerZIndex,u=l.formItemLayout;return n.a.createElement(J.a,{title:t,width:i,onClose:r,visible:a,zIndex:s},n.a.createElement(K.a,{className:"users-form",labelCol:u.labelCol,wrapperCol:u.wrapperCol,onSubmit:this.handleSubmitThrottled},n.a.createElement(T.a,{gutter:16,style:{marginBottom:"20px"}},n.a.createElement(K.a.Item,{label:"Код",hasFeedback:!0},o("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(n.a.createElement(G.a,{style:{width:"65%"},min:1,placeholder:"Код пользователя"}))),n.a.createElement(K.a.Item,{label:"Имя",hasFeedback:!0},o("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(n.a.createElement(Q.a,{placeholder:"Имя пользователя"}))),n.a.createElement(K.a.Item,{label:"Логин",hasFeedback:!0},o("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(n.a.createElement(Q.a,{placeholder:"Логин пользователя"}))),n.a.createElement(K.a.Item,{label:"Пароль",hasFeedback:!0},o("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(n.a.createElement(Q.a.Password,null))),n.a.createElement(K.a.Item,{label:"Повторить пароль",hasFeedback:!0},o("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(n.a.createElement(Q.a.Password,{onBlur:this.handleConfirmBlur}))),n.a.createElement(K.a.Item,{label:"Администратор"},o("is_admin",{valuePropName:"checked"})(n.a.createElement(Z.a,null))),n.a.createElement(K.a.Item,{label:"Перепечать"},o("is_reprint_admin",{valuePropName:"checked"})(n.a.createElement(Z.a,null)))),n.a.createElement(T.a,{className:"users-form-footer-button"},n.a.createElement(D.a,{onClick:r,style:{marginRight:8}},"Закрыить"),n.a.createElement(D.a,{type:"primary",htmlType:"submit"},"Отправить"))))}}])&&X(r.prototype,a),o&&X(r,o),t}(a.Component);re.propTypes={form:l.a.objectOf(l.a.func).isRequired,title:l.a.string.isRequired,visible:l.a.bool.isRequired,submitForm:l.a.func.isRequired,onClose:l.a.func.isRequired};var ae=n.a.memo(re),ne=z.a.create({name:"user_add_form"})(ae),oe=r(22),le=r(132);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function se(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ce(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function me(e,t){return(me=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var pe=I.a.Header,fe=I.a.Content,be=I.a.Sider,ye={},he=function(e){function t(e){var r,a,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,n=ue(t).call(this,e),r=!n||"object"!==ie(n)&&"function"!=typeof n?ce(a):n,de(ce(r),"onCloseUserAddForm",(function(){r.setState({visibleUserAddForm:!1})})),de(ce(r),"onOpenUserAddForm",(function(){var e=r.state.visibleUserAddForm;r.setState({visibleUserAddForm:!e})})),de(ce(r),"switchSiderMenu",(function(){var e=r.state.collapsedSiderMenu;r.setState({collapsedSiderMenu:!e})})),r.state={siderWidth:200,menuSelectedKeys:["left-menu-1"],collapsedSiderMenu:e.collapsedSiderMenu,visibleUserAddForm:e.visibleUserAddForm},r.modelItemsDebounced=j()(e.modelItems,250),e.modelCurrentUser(),e.modelServer(),r}var r,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&me(e,t)}(t,e),r=t,(a=[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,a=r.items,n=r.header,o=r.loading,l=r.location.query,i=this.state,s=i.page,u=i.collapsedSiderMenu,c=i.visibleUserAddForm;return new oe.b({params:["name","code","login"],header:n,page:s,query:l,nextHeader:e.header,model:this.modelItemsDebounced}).isUpdate(),a!==e.items||JSON.stringify(n)!==JSON.stringify(e.header)||o!==e.loading||u!==t.collapsedSiderMenu||c!==t.visibleUserAddForm}},{key:"componentWillUnmount",value:function(){this.modelItemsDebounced.cancel()}},{key:"render",value:function(){var e=this,t=this.props,r=t.loading,a=t.setHeader,o=t.sort,l=t.items,i=t.access,s=t.modelDelete,u=t.paginate,c=t.modelItems,m=t.modelAdd,d=t.header,p=d.code,f=d.name,b=d.login,y=t.location.query,h=this.state,E=h.siderWidth,v=h.collapsedSiderMenu,g=h.menuSelectedKeys,w=h.visibleUserAddForm;return n.a.createElement(C.b,{context:ye},n.a.createElement(I.a,null,n.a.createElement(be,{width:E,trigger:null,collapsible:!0,collapsed:v},n.a.createElement("div",{className:"logo"},"USER"),n.a.createElement(A.a,{theme:"dark",mode:"inline",defaultSelectedKeys:g},n.a.createElement(A.a.Item,{key:"left-menu-1"},n.a.createElement(_.b,{to:"/"},n.a.createElement(P.a,{type:"team"}),n.a.createElement("span",null,"Пользователи"))),n.a.createElement(A.a.Item,{key:"left-menu-2"},n.a.createElement(_.b,{to:"/role"},n.a.createElement(P.a,{type:"cluster"}),n.a.createElement("span",null,"Роли"))))),n.a.createElement(I.a,null,n.a.createElement(F.a,{tip:"Загрузка...",size:"large",spinning:r},n.a.createElement(C.a,{title:"Users"}),n.a.createElement(pe,null,n.a.createElement(U.a,{subTitle:"Пользователи",title:n.a.createElement("span",null,n.a.createElement(P.a,{className:"trigger",type:v?"menu-unfold":"menu-fold",onClick:this.switchSiderMenu}),"Users"),extra:[n.a.createElement(D.a,{key:"add-user",className:"btn-user-add",type:"primary",icon:"user-add",size:"small",onClick:function(){return e.onOpenUserAddForm()}},"Добавить пользователя"),n.a.createElement(oe.c,{key:"logout-1"})]})),n.a.createElement(fe,{className:"user-list"},n.a.createElement(T.a,null,n.a.createElement(N.a,{span:24},n.a.createElement(oe.g,{overlayClassName:"table-users",striped:!1,thead:[n.a.createElement("th",{key:"ht-1"},n.a.createElement(oe.a,null,n.a.createElement(oe.e,{callback:a,model:"code",value:p,placeholder:"Код"}),n.a.createElement(oe.f,{id:"code",fsort:o}))),n.a.createElement("th",{key:"ht-2"},n.a.createElement(oe.a,null,n.a.createElement(oe.e,{callback:a,model:"name",value:f,placeholder:"Имя"}),n.a.createElement(oe.f,{id:"name",fsort:o}))),n.a.createElement("th",{key:"ht-3"},n.a.createElement(oe.a,null,n.a.createElement(oe.e,{callback:a,model:"login",value:b,placeholder:"Логин"}),n.a.createElement(oe.f,{id:"login",fsort:o}))),n.a.createElement("th",{key:"ht-4"},n.a.createElement(oe.h,null,"Админ")),n.a.createElement("th",{key:"ht-5"},n.a.createElement(oe.h,null,"Перепечать")),n.a.createElement("th",{key:"ht-6"})]},l?k()(l,(function(e){return n.a.createElement(H,{key:e.operator_id,userId:e.operator_id,userCode:e.operator_code,userName:e.operator_name,userLogin:e.operator_login,isAdmin:e.is_admin,isReprintAdmin:e.is_reprint_admin,access:i,onDeleteUser:s})})):null)),n.a.createElement(N.a,{span:24},u?n.a.createElement(oe.d,{url:"/",data:u,onQuery:c}):null),n.a.createElement(ne,{title:"Добавить пользователя",visible:w,urlQuery:y,submitForm:m,onClose:this.onCloseUserAddForm,wrappedComponentRef:function(t){e.form=t}})))))))}}])&&se(r.prototype,a),o&&se(r,o),t}(n.a.Component);he.defaultProps={items:null,paginate:null},he.propTypes={collapsedSiderMenu:l.a.bool.isRequired,items:l.a.arrayOf(l.a.object),loading:l.a.bool.isRequired,modelAdd:l.a.func.isRequired,modelCurrentUser:l.a.func.isRequired,modelDelete:l.a.func.isRequired,modelItems:l.a.func.isRequired,modelServer:l.a.func.isRequired,setHeader:l.a.func.isRequired,sort:l.a.func.isRequired,visibleUserAddForm:l.a.bool.isRequired,access:le.a.isRequired,location:le.b.isRequired,header:l.a.shape({code:l.a.string,login:l.a.string,name:l.a.string,status:l.a.string}).isRequired,paginate:le.c};var Ee=he;function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var we=Object(i.c)((function(e){var t="system",r={},a={},n=Object(b.a)(S,t,e),o=function(){return n("userCurrent")},l=function(e){return n("userItems",e)},s=function(e){return n("userHeader",e)},u=function(e){return n("userAdd",e,(function(e){return l(r.location.query),e}))},c=function(e){return n("userDelete",{id:e},(function(e){return l(r.location.query),e}))},m=function(){s(r.location.query),l(r.location.query)},d=function(e,t){r.location.query[e]=t,s(r.location.query)},p=function(e){r.location.query.sort=e,l(r.location.query)};return function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){ge(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{loading:f()(e.system.userItems),header:f()(e.system.userItems)?{}:e.system.userHeader,items:f()(e.system.userItems)?null:e.system.userItems.data,paginate:f()(e.system.userItems)?null:e.system.userItems.paginate,access:f()(e.system.userItems)?{}:e.system.userItems.access,current:f()(e.system.userCurrent)?{}:e.system.userCurrent.data,setHeader:d,modelCurrentUser:o,modelItems:l,modelHeader:s,modelServer:m,modelAdd:u,modelDelete:c,sort:p});return r=t,Object(i.d)(a,n)||(a=n),a}}))(Ee),Oe=(r(503),function(e){var t=e.location,r=e.visibleUserAddForm,a=e.collapsedSiderMenu;return n.a.createElement(i.a,{store:d},n.a.createElement(we,{location:t,visibleUserAddForm:r,collapsedSiderMenu:a}))});Oe.defaultProps={visibleUserAddForm:!1,collapsedSiderMenu:!0},Oe.propTypes={location:l.a.oneOfType([l.a.any]).isRequired,visibleUserAddForm:l.a.bool,collapsedSiderMenu:l.a.bool};t.a=Oe},503:function(e,t,r){}}]);
//# sourceMappingURL=users.js.map