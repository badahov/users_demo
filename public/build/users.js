(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[9],{131:function(e,t,r){"use strict";t.a={getComponent:function(e,t){Promise.all([r.e(1),r.e(2),r.e(0),r.e(6),r.e(5),r.e(3),r.e(4),r.e(8),r.e(7),r.e(9),r.e(10),r.e(20)]).then(function(e){t(null,r(226).default)}.bind(null,r)).catch(r.oe)}}},15:function(e,t,r){"use strict";t.a={model:"user",api:{items:"interface-users/items",delete:"interface-users/user-delete",add:"interface-users/user-add",current:"interface-users/user-current"},middleware:["USER_ADD","USER_DELETE","USER_ITEMS","USER_CURRENT","USER_HEADER"]}},221:function(e,t,r){},226:function(e,t,r){"use strict";r.r(t);var n={};r.r(n),r.d(n,"user",(function(){return y}));var a=r(0),o=r.n(a),i=r(19),s=r(9),l=r(43),c=r(37),u=r(15),p=function(e){return function(t){return function(r){if(!u.a.middleware.includes(r.type))return t(r);Object(c.a)(e,r)}}},d=r(59),m=u.a.model.toUpperCase(),f=function(e){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1?arguments[1]:void 0;return e.includes(r.type)?r.data:t}},y=Object(d.combineForms)({loading:f(["".concat(m,"_ITEMS_LOADING"),"".concat(m,"_DELETE_LOADING")]),items:f(["".concat(m,"_ITEMS_LOADED")]),save:f(["".concat(m,"_ADD_LOADED")]),header:f(["".concat(m,"_HEADER_LOADED")]),current:f(["".concat(m,"_CURRENT_LOADED")])},u.a.model),b=Object(s.applyMiddleware)(p,l.a)(s.createStore)(Object(s.combineReducers)(n)),h=r(4),E=r(44),g=r.n(E),v=r(12),_=r(5);function w(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:_.d.post;return new _.d({pointApi:e,type:r,data:t})}function O(e,t,r){switch(e.toUpperCase()){case"HEADER":return{code:0!==t.code?t.code:"",name:0!==t.name?t.name:"",login:0!==t.login?t.login:"",status:0===t.status?"0":"1"};case"ITEMS":return new _.d({pointApi:u.a.api.items,data:t}).result();case"DELETE":return w(u.a.api.delete,t,_.d.post).result(r).then((function(e){if(e)return w(u.a.api.items).result()}));case"ADD":return w(u.a.api.add,t,_.d.post).result(r).then((function(e){if(e)return w(u.a.api.items).result()}));case"CURRENT":return new _.d({domain:h.a.domain.auth,type:_.d.get,pointApi:u.a.api.current}).result()}}var S=u.a.model.toUpperCase();function U(e,t,r){var n=e.toUpperCase();return{type:"".concat(S,"_").concat(n),actions:["".concat(S,"_").concat(n,"_LOADING"),"".concat(S,"_").concat(n,"_LOADED"),"".concat(S,"_").concat(n,"_LOAD_FAILURE")],promise:O(e,t,r)}}var A=r(236),q=r(229),j=r(101),D=r(3),C=r(134),P=r(243),R=r(26),k=r(54),F=r(29),T=r(1),I=r.n(T),x=r(237);function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,t){return!t||"object"!==M(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H,W,K,Q=function(e){function t(){return N(this,t),z(this,B(t).apply(this,arguments))}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this,t=this.props,r=t.isAdmin,n=t.isReprintAdmin,a=t.userCode,i=t.userName,s=t.userLogin,l=t.access,c=t.userId,u=r?"Да":"Нет",p=n?"Да":"Нет";return o.a.createElement("tr",null,o.a.createElement("td",null,a),o.a.createElement("td",null,i),o.a.createElement("td",null,s),o.a.createElement("td",null,u),o.a.createElement("td",null,p),o.a.createElement("td",{className:"box-button"},o.a.createElement(R.a.Group,null,l.user.update?o.a.createElement(v.a,{className:"ant-btn ant-btn-primary ant-btn-sm ant-btn-icon-only",title:"Изменить",to:"/user/edit/".concat(c,"/data")},o.a.createElement(D.a,{type:"edit"})):null,l.user.delete?o.a.createElement(x.a,{title:"Удалить пользователя?",onConfirm:function(){return e.props.onDeleteUser(c)},okText:"Да",cancelText:"Нет",placement:"left",zIndex:1050},o.a.createElement(R.a,{type:"primary",size:"small",icon:"delete"})):null)))}}])&&L(r.prototype,n),a&&L(r,a),t}(a.Component);H=Q,W="propTypes",K={access:I.a.objectOf(I.a.shape({user:I.a.arrayOf(I.a.shape({delete:I.a.bool.isRequired,update:I.a.bool.isRequired}))})),isAdmin:I.a.bool,isReprintAdmin:I.a.bool,userCode:I.a.number,userId:I.a.number.isRequired,userLogin:I.a.string.isRequired,userName:I.a.string.isRequired},W in H?Object.defineProperty(H,W,{value:K,enumerable:!0,configurable:!0,writable:!0}):H[W]=K;var J=r(238),Z=r(245),V=r(239),X=r(242),Y=r(240);function $(e){return($="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(){return(ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function te(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function re(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ne(e,t){return!t||"object"!==$(t)&&"function"!=typeof t?oe(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e,t){return(ie=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var le={position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:2e3},ce={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12}}},ue=function(e){function t(){var e,r;te(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return se(oe(r=ne(this,(e=ae(t)).call.apply(e,[this].concat(a)))),"state",{DrawerWidth:550,DrawerZIndex:1050}),se(oe(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,r.props.actionUser("add",t,(function(e){return"ok"===e.status?(e.msg&&(q.a.success(e.msg),r.props.actionUser("items",r.props.urlQuery)),!0):e.msg?(q.a.error(r._errorMsg(e.msg)),!1):void 0})))}))})),se(oe(r),"onClose",(function(){r.props.onClose()})),se(oe(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),se(oe(r),"compareToFirstPassword",(function(e,t,n){var a=r.props.form;t&&t!==a.getFieldValue("password")?n("Пароли не совпадают!"):n()})),se(oe(r),"validateToNextPassword",(function(e,t,n){var a=r.props.form;t&&r.state.confirmDirty&&a.validateFields(["confirm"],{force:!0}),n()})),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ie(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return o.a.createElement(J.a,{title:this.props.title,width:this.state.DrawerWidth,onClose:this.onClose,visible:this.props.visible,zIndex:this.state.DrawerZIndex},o.a.createElement(Z.a,ee({},ce,{onSubmit:this.handleSubmit}),o.a.createElement(k.a,{gutter:16,style:{marginBottom:"20px"}},o.a.createElement(Z.a.Item,{label:"Код",hasFeedback:!0},e("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(o.a.createElement(V.a,{style:{width:"65%"},min:1,placeholder:"Код пользователя"}))),o.a.createElement(Z.a.Item,{label:"Имя",hasFeedback:!0},e("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(o.a.createElement(X.a,{placeholder:"Имя пользователя"}))),o.a.createElement(Z.a.Item,{label:"Логин",hasFeedback:!0},e("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(o.a.createElement(X.a,{placeholder:"Логин пользователя"}))),o.a.createElement(Z.a.Item,{label:"Пароль",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(o.a.createElement(X.a.Password,null))),o.a.createElement(Z.a.Item,{label:"Повторить пароль",hasFeedback:!0},e("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(o.a.createElement(X.a.Password,{onBlur:this.handleConfirmBlur}))),o.a.createElement(Z.a.Item,{label:"Администратор"},e("is_admin",{valuePropName:"checked"})(o.a.createElement(Y.a,null))),o.a.createElement(Z.a.Item,{label:"Перепечать"},e("is_reprint_admin",{valuePropName:"checked"})(o.a.createElement(Y.a,null)))),o.a.createElement(k.a,{style:le},o.a.createElement(R.a,{onClick:this.onClose,style:{marginRight:8}},"Закрыить"),o.a.createElement(R.a,{type:"primary",htmlType:"submit"},"Отправить"))))}}])&&re(r.prototype,n),a&&re(r,a),t}(a.Component),pe=Z.a.create({name:"user_add_form",mapPropsToFields:function(e){return{}}})(ue);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fe(e){return(fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e,t){return(be=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function he(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}console.log("user index");var Ee=A.a.Header,ge=A.a.Content,ve=A.a.Sider,_e=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=fe(t).call(this,e),r=!a||"object"!==de(a)&&"function"!=typeof a?ye(n):a,he(ye(r),"onDeleteUser",(function(e){r.props.actionUser("delete",{operator_id:e},(function(e){return"ok"===e.status?(e.msg&&(q.a.success(e.msg),r.props.actionUser("items",r.props.location.query)),!0):e.msg?(q.a.error(r._errorMsg(e.msg)),!1):void 0}))})),he(ye(r),"onCloseUserAddForm",(function(){r.setState({visibleUserAddForm:!1})})),he(ye(r),"onOpenUserAddForm",(function(){r.setState({visibleUserAddForm:!r.state.visibleUserAddForm})})),he(ye(r),"_switchSiderMenu",(function(){r.setState({collapsedSiderMenu:!r.state.collapsedSiderMenu})})),he(ye(r),"_fsort",(function(e){r.props.location.query.sort=e,r.props.actionUser("items",r.props.location.query)})),he(ye(r),"_loadingDataServer",(function(){r.props.actionUser("header",r.props.location.query),r.props.actionUser("items",r.props.location.query)})),he(ye(r),"shouldComponentUpdate",(function(e,t){var n=r.props,a=n.location,o=n.header,i=!1;return a.query.name!==e.header.name&&o.name!==e.header.name?(a.query.name=e.header.name,h.a.history.push({pathname:"/",query:a.query}),i=!0):""===a.query.name&&(delete a.query.name,h.a.history.push({pathname:"/",query:a.query})),a.query.code!==e.header.code&&o.code!==e.header.code?(a.query.code=e.header.code,h.a.history.push({pathname:"/",query:a.query}),i=!0):""===a.query.code&&(delete a.query.code,h.a.history.push({pathname:"/",query:a.query})),a.query.login!==e.header.login&&o.login!==e.header.login?(a.query.login=e.header.login,h.a.history.push({pathname:"/",query:a.query}),i=!0):""===a.query.login&&(delete a.query.login,h.a.history.push({pathname:"/",query:a.query})),i&&r.props.actionUser("items",r.props.location.query),r.props.loading&&!e.loading&&r.setState({loading:e.loading}),r.props.loading!==e.loading||r.state.collapsedSiderMenu!==t.collapsedSiderMenu||r.state.visibleUserAddForm!==t.visibleUserAddForm||r.props.items!==e.items})),r.state={siderWidth:200,menuSelectedKeys:["left-menu-1"],collapsedSiderMenu:e.collapsedSiderMenu,visibleUserAddForm:e.visibleUserAddForm},e.actionUser("current"),r._loadingDataServer(),r}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&be(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return o.a.createElement(A.a,null,o.a.createElement(ve,{width:this.state.siderWidth,trigger:null,collapsible:!0,collapsed:this.state.collapsedSiderMenu},o.a.createElement("div",{className:"logo"},"USER"),o.a.createElement(j.a,{theme:"dark",mode:"inline",defaultSelectedKeys:this.state.menuSelectedKeys},o.a.createElement(j.a.Item,{key:"left-menu-1"},o.a.createElement(v.a,{to:"/"},o.a.createElement(D.a,{type:"team"}),o.a.createElement("span",null,"Пользователи"))),o.a.createElement(j.a.Item,{key:"left-menu-2"},o.a.createElement(v.a,{to:"/role"},o.a.createElement(D.a,{type:"cluster"}),o.a.createElement("span",null,"Роли"))))),o.a.createElement(A.a,null,o.a.createElement(C.a,{tip:"Загрузка...",size:"large",spinning:this.props.loading},o.a.createElement(g.a,{title:"Users"}),o.a.createElement(Ee,null,o.a.createElement(P.a,{title:o.a.createElement("span",null,o.a.createElement(D.a,{className:"trigger",type:this.state.collapsedSiderMenu?"menu-unfold":"menu-fold",onClick:this._switchSiderMenu}),"Users"),subTitle:"Пользователи",extra:[o.a.createElement(R.a,{key:"add-user",className:"btn-user-add",onClick:function(){return e.onOpenUserAddForm()},type:"primary",icon:"user-add",size:"small"},"Добавить пользователя"),o.a.createElement(_.b,{key:"logout-1"})]})),o.a.createElement(ge,{className:"user-list"},o.a.createElement(k.a,null,o.a.createElement(F.a,{span:24},o.a.createElement(_.g,{overlayClassName:"table-users",striped:!1,thead:[o.a.createElement(_.a,null,o.a.createElement(_.e,{model:"user.header.code",value:this.props.header.code,placeholder:"Код"}),o.a.createElement(_.f,{id:"code",fsort:this._fsort})),o.a.createElement(_.a,null,o.a.createElement(_.e,{model:"user.header.name",value:this.props.header.name,placeholder:"Имя"}),o.a.createElement(_.f,{id:"name",fsort:this._fsort})),o.a.createElement(_.a,null,o.a.createElement(_.e,{model:"user.header.login",value:this.props.header.login,placeholder:"Логин"}),o.a.createElement(_.f,{id:"login",fsort:this._fsort})),o.a.createElement("span",null,"Админ"),o.a.createElement("span",null,"Перепечать"),o.a.createElement("span",null)]},this.props.items?this.props.items.map((function(t){return o.a.createElement(Q,{key:t.operator_id,userId:t.operator_id,userCode:t.operator_code,userName:t.operator_name,userLogin:t.operator_login,isAdmin:t.is_admin,isReprintAdmin:t.is_reprint_admin,access:e.props.access,onDeleteUser:e.onDeleteUser})})):null)),o.a.createElement(F.a,{span:24},this.props.paginate?o.a.createElement(_.c,{url:"/",data:this.props.paginate,onQuery:function(t){e.props.actionUser("items",t)}}):null),o.a.createElement(pe,{title:"Добавить пользователя",visible:this.state.visibleUserAddForm,urlQuery:this.props.location.query,actionUser:this.props.actionUser,onClose:this.onCloseUserAddForm,wrappedComponentRef:function(t){return e.form=t}}))))))}}])&&me(r.prototype,n),a&&me(r,a),t}(o.a.Component);he(_e,"defaultProps",{loading:!0,location:{query:{}}});var we=Object(i.connect)((function(e){return{loading:!!Array.isArray(e.user.loading)||e.user.loading,header:e.user.header,items:e.user.items.data,paginate:e.user.items.paginate,access:e.user.items.access,current:e.user.current}}),(function(e){return Object(s.bindActionCreators)({actionUser:U,dispatch:e},e)}))(_e);r(221);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qe(e){return(qe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var De=function(e){function t(){return Se(this,t),Ae(this,qe(t).apply(this,arguments))}var r,n,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){return o.a.createElement(i.Provider,{store:b},o.a.createElement(we,{header:this.props.header,location:this.props.location,visibleUserAddForm:this.props.visibleUserAddForm,collapsedSiderMenu:this.props.collapsedSiderMenu}))}}])&&Ue(r.prototype,n),a&&Ue(r,a),t}(a.Component);!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(De,"defaultProps",{visibleUserAddForm:!1,collapsedSiderMenu:!0});t.default=De}}]);
//# sourceMappingURL=users.js.map