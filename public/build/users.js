(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[11],{153:function(e,t,r){"use strict";var n=r(55),a=r.n(n);t.a={getComponent:function(e,t){Promise.all([r.e(1),r.e(2),r.e(0),r.e(3),r.e(5),r.e(4),r.e(7),r.e(6),r.e(8),r.e(11),r.e(20)]).then(r.bind(null,278)).then((function(e){return t(null,e.default)})).catch((function(){return a.a}))}}},272:function(e,t,r){},278:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),o=r(14),l=r(15),s=r(59),i=r(56),u=r(46),c=Object(l.applyMiddleware)(Object(s.a)("system"),u.a)(l.createStore)(Object(l.combineReducers)({system:Object(i.a)({name:"system",models:[{name:"user",points:["header","items","current"]}]})})),m=r(60),p=r(4),d=r(5),f="interface-users/items",y="interface-users/user-delete",b="interface-users/user-add",h="interface-users/user-current";function E(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p.e.post;return new p.e({pointApi:e,type:r,data:t})}function v(e,t,r){switch(e){case"userHeader":return{code:0!==t.code?t.code:"",name:0!==t.name?t.name:"",login:0!==t.login?t.login:"",status:0===t.status?"0":"1"};case"userItems":return new p.e({pointApi:f,data:t}).result();case"userDelete":return E(y,t,p.e.post).result(r).then((function(e){if(e)return E(f).result()}));case"userAdd":return E(b,t,p.e.post).result(r).then((function(e){if(e)return E(f).result()}));case"userCurrent":return new p.e({domain:d.a.domain.auth,type:p.e.get,pointApi:h}).result()}}var g=r(47),w=r.n(g),O=r(11),S=r(292),j=r(111),_=r(3),P=r(159),k=r(299),C=r(26),A=r(61),I=r(29),F=r(1),q=r.n(F),U=r(293);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function R(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var H=function(e){function t(){return D(this,t),R(this,M(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this,t=this.props,r=t.isAdmin,n=t.isReprintAdmin,o=t.userCode,l=t.userName,s=t.userLogin,i=t.access,u=t.userId,c=r?"Да":"Нет",m=n?"Да":"Нет";return a.a.createElement("tr",null,a.a.createElement("td",null,o),a.a.createElement("td",null,l),a.a.createElement("td",null,s),a.a.createElement("td",null,c),a.a.createElement("td",null,m),a.a.createElement("td",{className:"box-button"},a.a.createElement(C.a.Group,null,i.user.update?a.a.createElement(O.a,{className:"ant-btn ant-btn-primary ant-btn-sm ant-btn-icon-only",title:"Изменить",to:"/user/edit/".concat(u,"/data")},a.a.createElement(_.a,{type:"edit"})):null,i.user.delete?a.a.createElement(U.a,{title:"Удалить пользователя?",onConfirm:function(){return e.props.onDeleteUser(u)},okText:"Да",cancelText:"Нет",placement:"left",zIndex:1050},a.a.createElement(C.a,{type:"primary",size:"small",icon:"delete"})):null)))}}])&&T(r.prototype,n),o&&T(r,o),t}(n.Component);H.propTypes={access:q.a.objectOf(q.a.shape({user:q.a.arrayOf(q.a.shape({delete:q.a.bool.isRequired,update:q.a.bool.isRequired}))})),isAdmin:q.a.bool,isReprintAdmin:q.a.bool,userCode:q.a.number,userId:q.a.number.isRequired,userLogin:q.a.string.isRequired,userName:q.a.string.isRequired};var z=H,B=r(158),W=r.n(B),K=r(294),L=r(302),J=r(295),Q=r(298),Z=r(296);function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?te(e):t}function ee(e){return(ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ae={position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:2e3},oe={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12}}},le=function(e){function t(){var e,r;X(this,t);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return ne(te(r=$(this,(e=ee(t)).call.apply(e,[this].concat(a)))),"state",{DrawerWidth:550,DrawerZIndex:1050}),ne(te(r),"handleSubmit",(function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll((function(e,t){e||(delete t.confirm,r.props.submitForm(t))}))})),ne(te(r),"onClose",(function(){r.props.onClose()})),ne(te(r),"handleConfirmBlur",(function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})})),ne(te(r),"compareToFirstPassword",(function(e,t,n){var a=r.props.form;t&&t!==a.getFieldValue("password")?n("Пароли не совпадают!"):n()})),ne(te(r),"validateToNextPassword",(function(e,t,n){var a=r.props.form;t&&r.state.confirmDirty&&a.validateFields(["confirm"],{force:!0}),n()})),r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return a.a.createElement(K.a,{title:this.props.title,width:this.state.DrawerWidth,onClose:this.onClose,visible:this.props.visible,zIndex:this.state.DrawerZIndex},a.a.createElement(L.a,V({},oe,{onSubmit:this.handleSubmit}),a.a.createElement(A.a,{gutter:16,style:{marginBottom:"20px"}},a.a.createElement(L.a.Item,{label:"Код",hasFeedback:!0},e("operator_code",{rules:[{required:!0,message:"Пожалуйста, ввидите код пользователя"}]})(a.a.createElement(J.a,{style:{width:"65%"},min:1,placeholder:"Код пользователя"}))),a.a.createElement(L.a.Item,{label:"Имя",hasFeedback:!0},e("operator_name",{rules:[{required:!0,message:"Пожалуйста, ввидите имя пользователя"}]})(a.a.createElement(Q.a,{placeholder:"Имя пользователя"}))),a.a.createElement(L.a.Item,{label:"Логин",hasFeedback:!0},e("operator_login",{rules:[{required:!0,message:"Пожалуйста, ввидите логин пользователя"}]})(a.a.createElement(Q.a,{placeholder:"Логин пользователя"}))),a.a.createElement(L.a.Item,{label:"Пароль",hasFeedback:!0},e("password",{rules:[{required:!0,message:"Пожалуйста, введите пароль!"},{validator:this.validateToNextPassword}]})(a.a.createElement(Q.a.Password,null))),a.a.createElement(L.a.Item,{label:"Повторить пароль",hasFeedback:!0},e("confirm",{rules:[{required:!0,message:"Пожалуйста, повторите пароль!"},{validator:this.compareToFirstPassword}]})(a.a.createElement(Q.a.Password,{onBlur:this.handleConfirmBlur}))),a.a.createElement(L.a.Item,{label:"Администратор"},e("is_admin",{valuePropName:"checked"})(a.a.createElement(Z.a,null))),a.a.createElement(L.a.Item,{label:"Перепечать"},e("is_reprint_admin",{valuePropName:"checked"})(a.a.createElement(Z.a,null)))),a.a.createElement(A.a,{style:ae},a.a.createElement(C.a,{onClick:this.onClose,style:{marginRight:8}},"Закрыить"),a.a.createElement(C.a,{type:"primary",htmlType:"submit"},"Отправить"))))}}])&&Y(r.prototype,n),o&&Y(r,o),t}(n.Component),se=W.a.create({name:"user_add_form",mapPropsToFields:function(e){return{}}})(le);function ie(e){return(ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pe(e,t){return(pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function de(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var fe=S.a.Header,ye=S.a.Content,be=S.a.Sider,he=function(e){function t(e){var r,n,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,a=ce(t).call(this,e),r=!a||"object"!==ie(a)&&"function"!=typeof a?me(n):a,de(me(r),"shouldComponentUpdate",(function(e,t){var n=r.props,a=n.items,o=n.location,l=n.header,s=n.modelItems,i=n.loading,u=n.location.query,c=r.state,m=c.page,d=c.collapsedSiderMenu,f=c.visibleUserAddForm;return new p.b({params:["name","code","login"],query:o.query,nextHeader:e.header,header:l,page:m,action:function(){s(u)}}).isUpdate(),i!==e.loading||d!==t.collapsedSiderMenu||f!==t.visibleUserAddForm||l!==e.header||a!==e.items})),de(me(r),"onCloseUserAddForm",(function(){r.setState({visibleUserAddForm:!1})})),de(me(r),"onOpenUserAddForm",(function(){r.setState({visibleUserAddForm:!r.state.visibleUserAddForm})})),de(me(r),"switchSiderMenu",(function(){r.setState({collapsedSiderMenu:!r.state.collapsedSiderMenu})})),r.state={siderWidth:200,menuSelectedKeys:["left-menu-1"],collapsedSiderMenu:e.collapsedSiderMenu,visibleUserAddForm:e.visibleUserAddForm},e.modelCurrentUser(),e.modelServer(),r}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pe(e,t)}(t,e),r=t,(n=[{key:"render",value:function(){var e=this;return a.a.createElement(S.a,null,a.a.createElement(be,{width:this.state.siderWidth,trigger:null,collapsible:!0,collapsed:this.state.collapsedSiderMenu},a.a.createElement("div",{className:"logo"},"USER"),a.a.createElement(j.a,{theme:"dark",mode:"inline",defaultSelectedKeys:this.state.menuSelectedKeys},a.a.createElement(j.a.Item,{key:"left-menu-1"},a.a.createElement(O.a,{to:"/"},a.a.createElement(_.a,{type:"team"}),a.a.createElement("span",null,"Пользователи"))),a.a.createElement(j.a.Item,{key:"left-menu-2"},a.a.createElement(O.a,{to:"/role"},a.a.createElement(_.a,{type:"cluster"}),a.a.createElement("span",null,"Роли"))))),a.a.createElement(S.a,null,a.a.createElement(P.a,{tip:"Загрузка...",size:"large",spinning:this.props.loading},a.a.createElement(w.a,{title:"Users"}),a.a.createElement(fe,null,a.a.createElement(k.a,{subTitle:"Пользователи",title:a.a.createElement("span",null,a.a.createElement(_.a,{className:"trigger",type:this.state.collapsedSiderMenu?"menu-unfold":"menu-fold",onClick:this.switchSiderMenu}),"Users"),extra:[a.a.createElement(C.a,{key:"add-user",className:"btn-user-add",type:"primary",icon:"user-add",size:"small",onClick:function(){return e.onOpenUserAddForm()}},"Добавить пользователя"),a.a.createElement(p.c,{key:"logout-1"})]})),a.a.createElement(ye,{className:"user-list"},a.a.createElement(A.a,null,a.a.createElement(I.a,{span:24},a.a.createElement(p.h,{overlayClassName:"table-users",striped:!1,thead:[a.a.createElement("th",{key:"ht-1"},a.a.createElement(p.a,null,a.a.createElement(p.f,{callback:this.props.setHeader,model:"code",value:this.props.header.code,placeholder:"Код"}),a.a.createElement(p.g,{id:"code",fsort:this.props.sort}))),a.a.createElement("th",{key:"ht-2"},a.a.createElement(p.a,null,a.a.createElement(p.f,{callback:this.props.setHeader,model:"name",value:this.props.header.name,placeholder:"Имя"}),a.a.createElement(p.g,{id:"name",fsort:this.props.sort}))),a.a.createElement("th",{key:"ht-3"},a.a.createElement(p.a,null,a.a.createElement(p.f,{callback:this.props.setHeader,model:"login",value:this.props.header.login,placeholder:"Логин"}),a.a.createElement(p.g,{id:"login",fsort:this.props.sort}))),a.a.createElement("th",{key:"ht-4"},a.a.createElement(p.a,null,a.a.createElement(p.i,null,"Админ"))),a.a.createElement("th",{key:"ht-5"},a.a.createElement(p.a,null,a.a.createElement(p.i,null,"Перепечать"))),a.a.createElement("th",{key:"ht-6"})]},this.props.items?this.props.items.map((function(t){return a.a.createElement(z,{key:t.operator_id,userId:t.operator_id,userCode:t.operator_code,userName:t.operator_name,userLogin:t.operator_login,isAdmin:t.is_admin,isReprintAdmin:t.is_reprint_admin,access:e.props.access,onDeleteUser:e.props.modelDelete})})):null)),a.a.createElement(I.a,{span:24},this.props.paginate?a.a.createElement(p.d,{url:"/",data:this.props.paginate,onQuery:this.props.modelItems}):null),a.a.createElement(se,{title:"Добавить пользователя",visible:this.state.visibleUserAddForm,urlQuery:this.props.location.query,submitForm:this.props.modelAdd,onClose:this.onCloseUserAddForm,wrappedComponentRef:function(t){return e.form=t}}))))))}}])&&ue(r.prototype,n),o&&ue(r,o),t}(a.a.Component);he.defaultProps={loading:!0,location:{query:{}}};var Ee=he;function ve(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var we=Object(o.connectAdvanced)((function(e){var t="system",r={},n={},a=Object(m.a)(v,t,e),l=function(){return a("userCurrent")},s=function(e){return a("userItems",e)},i=function(e){return a("userHeader",e)},u=function(e){return a("userAdd",e,(function(e){return s(r.location.query),e}))},c=function(e){return a("userDelete",{id:e},(function(e){return s(r.location.query),e}))},p=function(){i(r.location.query),s(r.location.query)},d=function(e,t){r.location.query[e]=t,i(r.location.query)},f=function(e){r.location.query.sort=e,s(r.location.query)};return function(e,t){var a=function(e){return null===e},m=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(r),!0).forEach((function(t){ge(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},t,{loading:!!a(e.system.userItems),header:a(e.system.userItems)?[]:e.system.userHeader,items:a(e.system.userItems)?null:e.system.userItems.data,paginate:a(e.system.userItems)?null:e.system.userItems.paginate,access:a(e.system.userItems)?null:e.system.userItems.access,current:a(e.system.userCurrent)?null:e.system.userCurrent.data,setHeader:d,modelCurrentUser:l,modelItems:s,modelHeader:i,modelServer:p,modelAdd:u,modelDelete:c,sort:f});return r=t,Object(o.shallowEqual)(n,m)||(n=m),n}}))(Ee),Oe=(r(272),function(e){var t=e.location,r=e.visibleUserAddForm,n=e.collapsedSiderMenu;return a.a.createElement(o.Provider,{store:c},a.a.createElement(we,{location:t,visibleUserAddForm:r,collapsedSiderMenu:n}))});Oe.defaultProps={visibleUserAddForm:!1,collapsedSiderMenu:!0};t.default=Oe}}]);
//# sourceMappingURL=users.js.map